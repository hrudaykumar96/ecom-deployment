import{R as D,u as F,a as v,r as f,v as y,s as k,w as S,j as e,L as q,x as P,k as _,p as L}from"./index-02v5Kx9p.js";import{F as A,c as O,d as B,a as C}from"./index.esm-BnwETkTM.js";import{i as I}from"./cardloader-DztRGZ-7.js";import{S as j}from"./index-DmWVH89f.js";import{A as z,P as G}from"./Profile_Details-ZbcIGot1.js";import"./ButtonLoader-Ds9zo1c0.js";const T=D.memo(()=>{var g,N;const r=F(),t=localStorage.getItem("token"),{loading:n,data:d}=v(a=>a.getorderslice),i=v(a=>a.postratingslice.response),$=a=>{const m={year:"numeric",month:"long",day:"numeric"};return new Date(a).toLocaleDateString("en-GB",m)};f.useEffect(()=>{t&&r(y(t))},[t,r]);const E=(a,m)=>{r(P({token:t,id:m,values:a}))};return f.useEffect(()=>{i&&(i!=null&&i.success&&(k("Success",`${i==null?void 0:i.success}`,"success"),r(S()),r(y(t))),i!=null&&i.error&&(k("Error","internal server error","error"),r(S())))},[i,r,t]),e.jsx("div",{className:"container pt-3 pb-3",children:((g=d==null?void 0:d.success)==null?void 0:g.length)>0&&e.jsxs(e.Fragment,{children:[e.jsx("h5",{className:"text-center",children:"My Orders"}),(N=d==null?void 0:d.success)==null?void 0:N.map((a,m)=>e.jsx("div",{className:"card mb-3",style:{maxWidth:"100%"},children:e.jsxs("div",{className:"row g-0",children:[a.items.map((s,x)=>{var c,l,p;return e.jsx("div",{className:"col-md-4",children:e.jsx(q,{to:`/description/${((c=s.product)==null?void 0:c._id)||""}`,children:e.jsx("img",{src:n?I:`https://ecom-lwfl.onrender.com:3000/${(l=s.product)==null?void 0:l.images[0]}`,className:"img-fluid rounded-start w-100",style:{height:"403px",objectFit:"fill"},alt:((p=s.product)==null?void 0:p.name)||"Product Image",loading:"lazy"})})},x)}),e.jsxs("div",{className:"col-md-8",children:[e.jsxs("div",{className:"card-body",children:[a.items.map((s,x)=>{var c;return e.jsxs("div",{children:[e.jsx("p",{className:"card-text",children:n?e.jsx(j,{}):(c=s==null?void 0:s.product)==null?void 0:c.about}),e.jsxs("p",{className:"card-text",children:["Quantity: ",s.quantity||1]}),e.jsxs("p",{className:"card-text",children:[e.jsx("i",{className:"fa-solid fa-indian-rupee-sign"})," ",n?e.jsx(j,{}):(s==null?void 0:s.price)||0]})]},x)}),e.jsx("p",{className:"card-text",children:e.jsxs("small",{className:"text-body-secondary",children:["Delivered on ",n?e.jsx(j,{}):$(a==null?void 0:a.createdAt)]})})]}),(a==null?void 0:a.reviewSubmitted)===!1&&e.jsx("div",{className:"card-footer",children:a.items.map((s,x)=>e.jsx(A,{initialValues:{rating:"",reviewText:""},validationSchema:O({rating:B().required("Rating is required").min(1).max(5),reviewText:C().required("Review is required")}),onSubmit:c=>{var l;return E(c,(l=s==null?void 0:s.product)==null?void 0:l._id)},children:({values:c,handleChange:l,handleBlur:p,handleSubmit:R,touched:u,errors:h})=>e.jsxs("form",{onSubmit:R,children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"form-check form-check-inline",children:[1,2,3,4,5].map(o=>{var b,w;return e.jsxs("div",{className:"form-check form-check-inline",children:[e.jsx("input",{className:"form-check-input",type:"radio",name:"rating",id:`rating-${(b=s.product)==null?void 0:b._id}-${o}`,value:o,onChange:l,onBlur:p,checked:c.rating===o}),e.jsx("label",{className:"form-check-label text-warning",htmlFor:`rating-${(w=s.product)==null?void 0:w._id}-${o}`,children:"â˜…".repeat(o)})]},o)})}),u.rating&&h.rating&&e.jsx("div",{className:"invalid-feedback d-block",children:h.rating})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("textarea",{name:"reviewText",className:`form-control ${u.reviewText&&h.reviewText?"is-invalid":""}`,onChange:l,onBlur:p,value:c.reviewText,placeholder:"Your review here"}),u.reviewText&&h.reviewText&&e.jsx("div",{className:"invalid-feedback",children:h.reviewText})]}),e.jsx("div",{className:"mb-3",children:e.jsx("button",{type:"submit",className:"btn btn-info",children:"Submit Review"})})]})},x))})]})]})},m))]})})});T.displayName="Orders";const M=()=>{f.useEffect(()=>{document.title="Ecom | Profile"},[]);const{loading:r,data:t}=v(n=>n.userdata);return r?e.jsx(_,{}):e.jsxs("div",{className:"min-vh-100 w-100",style:{backgroundColor:"rgb(217, 217, 217)"},children:[e.jsx(z,{data:t}),e.jsx(G,{data:t}),e.jsx(T,{})]})};M.propTypes={data:L.any};export{M as default};
